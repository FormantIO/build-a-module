import { useEffect, useState } from "react";
import reactLogo from "./assets/react.svg";
import "./App.css";

import { Authentication, App as FormantApp } from "@formant/data-sdk";

function App() {
  const [configuration, setConfiguration] = useState<string | undefined>(
    undefined
  );
  const [autenticated, setAuthenticated] = useState<boolean>(false);

  useEffect(() => {
    (async () => {
      await Authentication.waitTilAuthenticated();
      setAuthenticated(true);
      const currentConfig = await FormantApp.getCurrentModuleConfiguration();
      setConfiguration(currentConfig);
      FormantApp.addModuleConfigurationListener((config) => {
        setConfiguration(config.configuration);
      });
    })();
  }, []);

  return (
    <div className="App">
      <div>
        <img
          src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEzMSAzMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWw6c3BhY2U9InByZXNlcnZlIiB4bWxuczpzZXJpZj0iaHR0cDovL3d3dy5zZXJpZi5jb20vIiBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7Y2xpcC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjI7Ij4KICAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KDEuMDAwMzcsMCwwLDEsLTQ1LjAxNjUsLTE0NC41ODkpIj4KICAgICAgICA8ZyBpZD0iRGVmYXVsdCI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNjguNzYsMTQ3Ljk3MkwxNjguNzYsMTUzLjIzOUwxNzQuNjc4LDE1My4yMzlMMTc0LjY3OCwxNTYuNTU4TDE2OC43NiwxNTYuNTU4TDE2OC43NiwxNjQuMTg1QzE2OC43NiwxNjYuMzA2IDE2OS45MDgsMTY3LjMzMiAxNzEuNjE0LDE2Ny4zMzJDMTcyLjUxOSwxNjcuMzMyIDE3My42MzQsMTY2Ljk5IDE3NC41MzgsMTY2LjQwOEwxNzUuNjUyLDE2OS4zODVDMTc0LjAxNiwxNzAuMzQyIDE3Mi44MzIsMTcwLjY4NCAxNzEuMzcsMTcwLjY4NEMxNjcuNjQ2LDE3MC42ODQgMTY1LjEzOSwxNjguNjMxIDE2NS4xMzksMTY0LjQyNEwxNjUuMTM5LDE1Ni41NThMMTYxLjQxNSwxNTYuNTU4TDE2MS40MTUsMTUzLjIzOUwxNjUuMTM5LDE1My4yMzlMMTY1LjEzOSwxNDcuOTcyTDE2OC43NiwxNDcuOTcyWk02OC4zMjQsMTUyLjg2M0M3My4zMjgsMTUyLjg2MyA3Ny4zODQsMTU2Ljg0OSA3Ny4zODQsMTYxLjc2NkM3Ny4zODQsMTY2LjY4MyA3My4zMjgsMTcwLjY2OCA2OC4zMjQsMTcwLjY2OEM2My4zMiwxNzAuNjY4IDU5LjI2NCwxNjYuNjgzIDU5LjI2NCwxNjEuNzY2QzU5LjI2NCwxNTYuODQ5IDYzLjMyLDE1Mi44NjMgNjguMzI0LDE1Mi44NjNaTTEzMS41MTYsMTUyLjg2M0MxMzMuNjgxLDE1Mi44NjMgMTM1LjY2OSwxNTMuNjExIDEzNy4yMjcsMTU0Ljg1N0wxMzcuMjI3LDE1My4yNEwxNDAuODQ3LDE1My4yNEwxNDAuODQ3LDE3MC4yMDVMMTM3LjIyNywxNzAuMjA1TDEzNy4yMjcsMTY4LjY3NUMxMzUuNjY5LDE2OS45MjEgMTMzLjY4MSwxNzAuNjY5IDEzMS41MTYsMTcwLjY2OUMxMjYuNTEyLDE3MC42NjkgMTIyLjQ1NiwxNjYuNjgyIDEyMi40NTYsMTYxLjc2NkMxMjIuNDU2LDE1Ni44NDkgMTI2LjUxMiwxNTIuODYzIDEzMS41MTYsMTUyLjg2M1pNMTE0LjE0OSwxNTIuNzYxQzExNy43MzUsMTUyLjc2MSAxMjAuNjkzLDE1NS4zOTQgMTIwLjY5MywxNTkuMzk2TDEyMC42OTMsMTcwLjIwNUwxMTcuMTA4LDE3MC4yMDVMMTE3LjEwOCwxNjAuMTE1QzExNy4xMDgsMTU3LjYxOCAxMTUuNDM3LDE1Ni4wNDUgMTEzLjIwOSwxNTYuMDQ1QzExMC4zOSwxNTYuMDQ1IDEwOC41NDQsMTU3Ljk5NCAxMDguNTQ0LDE2MS43OTFMMTA4LjU0NCwxNzAuMjA1TDEwNC45MjUsMTcwLjIwNUwxMDQuOTI1LDE2MC4xMTVDMTA0LjkyNSwxNTcuNjE4IDEwMy4yNTQsMTU2LjA0NSAxMDEuMDI2LDE1Ni4wNDVDOTguMjQxLDE1Ni4wNDUgOTYuNDMxLDE1Ny45OTQgOTYuNDMxLDE2MS43OTFMOTYuNDMxLDE3MC4yMDVMOTIuODEyLDE3MC4yMDVMOTIuODEyLDE1My4yMzlMOTYuNDMxLDE1My4yMzlMOTYuNDMxLDE1NS4xNTVDOTcuNjg1LDE1My42NTEgOTkuNDk1LDE1Mi43NjEgMTAxLjk2NSwxNTIuNzYxQzEwNC40MzgsMTUyLjc2MSAxMDYuNTk2LDE1My44OSAxMDcuNzA5LDE1NS44NzRDMTA5LjEwMiwxNTMuOTU4IDExMS4yOTQsMTUyLjc2MSAxMTQuMTQ5LDE1Mi43NjFaTTE1My41OTcsMTUyLjc2MUMxNTcuNzQsMTUyLjc2MSAxNjAuNTI1LDE1NS43MDIgMTYwLjUyNSwxNTkuOTQzTDE2MC41MjUsMTcwLjIwNUwxNTYuODY5LDE3MC4yMDVMMTU2Ljg2OSwxNjAuNjYyQzE1Ni44NjksMTU3Ljg5MSAxNTUuMjMzLDE1Ni4wNDQgMTUyLjc2MiwxNTYuMDQ0QzE0OS42NjQsMTU2LjA0NCAxNDcuNjEsMTU4LjA5NyAxNDcuNjEsMTYyLjM3M0wxNDcuNjEsMTcwLjIwNUwxNDMuOTksMTcwLjIwNUwxNDMuOTksMTUzLjIzOUwxNDcuNjEsMTUzLjIzOUwxNDcuNjEsMTU1LjMyNkMxNDkuMDAzLDE1My42ODQgMTUxLjAyMiwxNTIuNzYxIDE1My41OTcsMTUyLjc2MVpNNjEuNjU4LDE0Ny4yODhMNjEuNjU4LDE1MC42MDZMNDguNzI1LDE1MC42MDZMNDguNzI1LDE1Ny40MTNMNTcuNTE5LDE1Ny40MTNMNTcuNTE5LDE2MC43MzFMNDguNzI1LDE2MC43MzFMNDguNzI1LDE3MC4yMDVMNDUsMTcwLjIwNUw0NSwxNDcuMjg4TDYxLjY1OCwxNDcuMjg4Wk04OS41MTIsMTUzLjE2NEM4OS44NDUsMTUzLjE2NCA5MC4xMzYsMTUzLjE2OCA5MC40NjksMTUzLjIzN0w5MC40NjksMTU2LjcxOUM5MC4xOTEsMTU2LjY4OCA4OS43ODUsMTU2LjY4NyA4OS40NzcsMTU2LjY4N0M4NS4wOTEsMTU2LjY4NyA4Mi45MzMsMTU5LjY5NyA4Mi45MzMsMTY0LjM0OUw4Mi45MzMsMTcwLjIwNUw3OS4zMTMsMTcwLjIwNUw3OS4zMTMsMTUzLjIzOUw4Mi45MzMsMTUzLjIzOUw4Mi45MzMsMTU2Ljk5NUM4NC4zMjYsMTU0LjczNyA4Ni41MTksMTUzLjE2NCA4OS41MTIsMTUzLjE2NFpNNjguMzI0LDE1Ni4xODdDNjUuMjY3LDE1Ni4xODcgNjIuNzg5LDE1OC42ODQgNjIuNzg5LDE2MS43NjZDNjIuNzg5LDE2NC44NDcgNjUuMjY3LDE2Ny4zNDQgNjguMzI0LDE2Ny4zNDRDNzEuMzgyLDE2Ny4zNDQgNzMuODYsMTY0Ljg0NyA3My44NiwxNjEuNzY2QzczLjg2LDE1OC42ODQgNzEuMzgyLDE1Ni4xODcgNjguMzI0LDE1Ni4xODdaTTEzMS41MTYsMTU2LjE4N0MxMjguNDU5LDE1Ni4xODcgMTI1Ljk4LDE1OC42ODUgMTI1Ljk4LDE2MS43NjZDMTI1Ljk4LDE2NC44NDcgMTI4LjQ1OSwxNjcuMzQ1IDEzMS41MTYsMTY3LjM0NUMxMzQuNTczLDE2Ny4zNDUgMTM3LjA1MSwxNjQuODQ3IDEzNy4wNTEsMTYxLjc2NkMxMzcuMDUxLDE1OC42ODUgMTM0LjU3MywxNTYuMTg3IDEzMS41MTYsMTU2LjE4N1oiIHN0eWxlPSJmaWxsOndoaXRlOyIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg=="
          className="logo"
          alt="Vite logo"
        />
      </div>
      <p className="read-the-docs">
        <ul>
          <li>
            Building a module uses the @formant/data-sdk npm to talk with
            Formant APIs.
          </li>
          <li>Each module can have a configuration driven by a JSON schema</li>
        </ul>
      </p>
      <p>
        {autenticated
          ? configuration ??
            "There's no configuration currently set, try launching the configuration editor in the top right."
          : `You are not authenticated, make sure your module url the proper query strings "?auth={auth}".`}
      </p>
    </div>
  );
}

export default App;
